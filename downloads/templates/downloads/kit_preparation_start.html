{% extends "base.html" %}
{% load static %}

{% block title %}Bonus — Kit Préparation{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 py-4">
  <h1 class="text-2xl font-bold text-gray-900 mb-4">Bonus — Soumission du texte</h1>
  <p class="text-gray-600 mb-6">PDF ≤ 4 pages, ≤ 5 Mo ou texte libre ≤ 2500 mots</p>

    {% if messages %}
      <div class="mb-6">
        {% for m in messages %}
          <div class="p-4 rounded-md {% if m.tags == 'error' %}bg-red-50 text-red-800 border border-red-200{% else %}bg-green-50 text-green-800 border border-green-200{% endif %}">
            {{ m }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="space-y-6" x-data="{ submissionType: 'file' }">
      {% csrf_token %}
      
      <!-- Informations client sur 2 colonnes -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Référence de commande (site)</label>
          <input type="text" name="{{ form.order_ref.name }}" value="{{ form.order_ref.value|default:'' }}" 
                 class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500" 
                 placeholder="Ex: EXT-12345">
          {% for e in form.order_ref.errors %}
            <div class="text-red-600 text-sm mt-1">{{ e }}</div>
          {% endfor %}
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Email d'achat</label>
          <input type="email" name="{{ form.email.name }}" value="{{ form.email.value|default:'' }}" 
                 class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500" 
                 placeholder="votre@email.com">
          {% for e in form.email.errors %}
            <div class="text-red-600 text-sm mt-1">{{ e }}</div>
          {% endfor %}
        </div>
      </div>
      
      <!-- Choix du type de soumission -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-3">Comment souhaitez-vous soumettre votre texte ?</label>
        <div class="space-y-3">
          <label class="flex items-center">
            <input type="radio" name="{{ form.submission_type.name }}" value="file" 
                   x-model="submissionType" class="mr-3 text-brand-600 focus:ring-brand-500">
            <span class="text-sm text-gray-700">Uploader un fichier PDF</span>
          </label>
          <label class="flex items-center">
            <input type="radio" name="{{ form.submission_type.name }}" value="text" 
                   x-model="submissionType" class="mr-3 text-brand-600 focus:ring-brand-500">
            <span class="text-sm text-gray-700">Coller le texte directement</span>
          </label>
        </div>
        {% for e in form.submission_type.errors %}
          <div class="text-red-600 text-sm mt-1">{{ e }}</div>
        {% endfor %}
      </div>
      
      <!-- Zone de fichier PDF -->
      <div x-show="submissionType === 'file'" x-transition>
        <label class="block text-sm font-medium text-gray-700 mb-2">Votre fichier PDF</label>
        <input type="file" name="{{ form.file.name }}" accept=".pdf" 
               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500">
        <p class="text-sm text-gray-500 mt-1">PDF uniquement, 4 pages max, 5 Mo max.</p>
        {% for e in form.file.errors %}
          <div class="text-red-600 text-sm mt-1">{{ e }}</div>
        {% endfor %}
      </div>
      
      <!-- Zone de texte libre -->
      <div x-show="submissionType === 'text'" x-transition>
        <label class="block text-sm font-medium text-gray-700 mb-2">Votre texte</label>
        <textarea name="{{ form.text_content.name }}" rows="15" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                  placeholder="Collez votre texte ici...">{{ form.text_content.value|default:'' }}</textarea>
        <p class="text-sm text-gray-500 mt-1">Maximum 2500 mots.</p>
        {% for e in form.text_content.errors %}
          <div class="text-red-600 text-sm mt-1">{{ e }}</div>
        {% endfor %}
      </div>
      
      <!-- Conditions d'acceptation -->
      <div class="flex items-start">
        <input type="checkbox" name="{{ form.accept_terms.name }}" id="{{ form.accept_terms.id_for_label }}"
               class="mt-1 mr-3 text-brand-600 focus:ring-brand-500">
        <label for="{{ form.accept_terms.id_for_label }}" class="text-sm text-gray-700">
          {{ form.accept_terms.label }}
        </label>
        {% for e in form.accept_terms.errors %}
          <div class="text-red-600 text-sm mt-1">{{ e }}</div>
        {% endfor %}
      </div>
      
      <!-- Bouton de soumission -->
      <button type="submit" class="w-full bg-brand-600 text-white py-3 px-4 rounded-md hover:bg-brand-700 transition-colors font-medium">
        Envoyer
      </button>
    </form>
</div>
{% endblock %}
