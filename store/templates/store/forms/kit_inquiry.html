{% extends "store/base.html" %}
{% block title %}Demande – Kit personnalisé{% endblock %}
{% block store_content %}
<section class="py-10">
  <div class="max-w-3xl mx-auto px-4">
    <a href="{% url 'store:offers' %}#kit" class="inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-800">
      <i data-lucide="arrow-left"></i> Retour aux offres
    </a>
    <h1 class="mt-3 text-2xl font-extrabold">Demander mon Kit personnalisé</h1>
    <p class="text-slate-600">Formulaire basé sur votre contexte (saisie + upload). Formats Word/Excel/PDF acceptés.</p>
    <form method="post" enctype="multipart/form-data" class="mt-6 space-y-6">
      {% csrf_token %}
      {{ form.non_field_errors }}
      <!-- Essentiel -->
      <div class="rounded-2xl border p-4 bg-white space-y-4">
        <h2 class="text-lg font-semibold">Vos coordonnées (obligatoire)</h2>
        <div class="grid md:grid-cols-3 gap-3">
          <div>{{ form.contact_name.label_tag }}{{ form.contact_name }}{{ form.contact_name.errors }}</div>
          <div>{{ form.email.label_tag }}{{ form.email }}{{ form.email.errors }}</div>
          <div>{{ form.phone.label_tag }}{{ form.phone }}{{ form.phone.errors }}</div>
        </div>
        <div class="grid md:grid-cols-2 gap-3">
          <div>{{ form.organization_name.label_tag }}{{ form.organization_name }}{{ form.organization_name.errors }}</div>
          <div>{{ form.statut_juridique.label_tag }}{{ form.statut_juridique }}{{ form.statut_juridique.errors }}</div>
        </div>
        <div class="grid md:grid-cols-3 gap-3">
          <div>{{ form.location.label_tag }}{{ form.location }}{{ form.location.errors }}</div>
          <div>{{ form.sector.label_tag }}{{ form.sector }}{{ form.sector.errors }}</div>
          <div>{{ form.budget_range.label_tag }}{{ form.budget_range }}{{ form.budget_range.errors }}</div>
        </div>
        <div>{{ form.mission_text.label_tag }}{{ form.mission_text }}{{ form.mission_text.errors }}</div>
      </div>
      <!-- Détails optionnels -->
      <details class="group rounded-2xl border p-4 bg-white">
        <summary class="cursor-pointer text-sm text-slate-700">Plus de détails (optionnel) — financement, audits, organisation, notes, fichiers</summary>
        <div class="mt-4 space-y-4">
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <div class="text-sm font-medium">Sources de financement</div>
              <div class="mt-2 space-y-1 text-sm">{{ form.funding_sources }}{{ form.funding_sources.errors }}</div>
            </div>
            <div>
              <div class="text-sm font-medium">Types d’audit/contrôle</div>
              <div class="mt-2 space-y-1 text-sm">{{ form.audits_types }}{{ form.audits_types.errors }}</div>
              <div class="mt-2">{{ form.audits_frequency.label_tag }}{{ form.audits_frequency }}{{ form.audits_frequency.errors }}</div>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-3">
            <div>{{ form.staff_size.label_tag }}{{ form.staff_size }}{{ form.staff_size.errors }}</div>
            <div>{{ form.org_chart_text.label_tag }}{{ form.org_chart_text }}{{ form.org_chart_text.errors }}</div>
          </div>
          <div>{{ form.notes_text.label_tag }}{{ form.notes_text }}{{ form.notes_text.errors }}</div>
          <div class="flex items-center gap-4 mt-4">
            <label class="text-sm font-medium mb-0">Uploader des documents (Word, Excel, PDF)</label>
            <input type="file" name="documents" id="id_documents" multiple accept=".pdf,.doc,.docx,.xls,.xlsx" class="px-3 py-2 rounded-xl border border-slate-300 focus:border-blue-500 bg-white file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:bg-emerald-50 file:text-emerald-700 hover:file:bg-emerald-100" />
          </div>
          <p class="mt-1 text-xs text-slate-500">Max 10 fichiers, 10 Mo/fichier.</p>
        </div>
      </details>
      <div class="hidden">{{ form.website }}</div>
      <div class="pt-3">
        <button class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-emerald-600 text-white hover:shadow">
          <i data-lucide="send"></i> Envoyer ma demande
        </button>
      </div>
      <p class="text-xs text-slate-500">En envoyant, vous acceptez d’être contacté par email pour une proposition personnalisée. Aucune diffusion de vos données.</p>
    </form>
  </div>
</section>
{% endblock store_content %}
